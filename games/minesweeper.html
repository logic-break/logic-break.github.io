<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∞–ø–µ—Ä</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #121212;
            color: #e0e0e0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            padding: 10px 0;
            border-bottom: 1px solid #333;
        }

        h1 {
            font-size: 2rem;
            color: #bb86fc;
        }

        .settings {
            display: flex;
            gap: 15px;
        }

        .language-selector, .difficulty-selector {
            display: flex;
            gap: 8px;
            background: #1e1e1e;
            padding: 5px;
            border-radius: 6px;
        }

        .lang-btn, .diff-btn {
            background: #333;
            color: #e0e0e0;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .lang-btn:hover, .diff-btn:hover {
            background: #444;
        }

        .lang-btn.active, .diff-btn.active {
            background: #bb86fc;
            color: #121212;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 10px;
        }

        .timer, .mines-counter, .lives {
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .mines-counter, .lives {
            color: #bb86fc;
        }

        .heart {
            color: #ff5252;
            font-size: 1.2rem;
        }

        .heart.empty {
            color: #444;
        }

        .minesweeper-board {
            display: grid;
            gap: 2px;
            background-color: #333;
            border: 2px solid #333;
            width: 100%;
            max-width: 450px;
            aspect-ratio: 1 / 1;
        }

        .cell {
            background-color: #2a2a2a;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
        }

        .cell:hover {
            background-color: #3a3a3a;
        }

        .cell.revealed {
            background-color: #1e1e1e;
            cursor: default;
        }

        .cell.revealed:hover {
            background-color: #1e1e1e;
        }

        .cell.flagged::after {
            content: 'üö©';
        }

        .cell.mine::after {
            content: 'üí£';
        }

        .cell.mine.revealed {
            background-color: #4a2a2a;
            animation: pulse 0.5s;
        }

        .cell.number-1 { color: #2196F3; }
        .cell.number-2 { color: #4CAF50; }
        .cell.number-3 { color: #f44336; }
        .cell.number-4 { color: #9C27B0; }
        .cell.number-5 { color: #FF9800; }
        .cell.number-6 { color: #00BCD4; }
        .cell.number-7 { color: #795548; }
        .cell.number-8 { color: #607D8B; }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 100%;
            max-width: 450px;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .action-btn {
            background: #333;
            color: #e0e0e0;
            border: none;
            padding: 12px 0;
            font-size: 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .action-btn:hover {
            background: #444;
        }

        .action-btn.primary {
            background: #bb86fc;
            color: #121212;
        }

        .action-btn.primary:hover {
            background: #9d6ad8;
        }

        .action-btn:disabled {
            background: #2a2a2a;
            color: #666;
            cursor: not-allowed;
        }

        .game-status {
            margin-top: 10px;
            font-size: 1.1rem;
            height: 24px;
            text-align: center;
        }

        .game-over {
            color: #ff5252;
            font-weight: bold;
        }

        .game-won {
            color: #4caf50;
            font-weight: bold;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }

        @media (max-width: 500px) {
            .minesweeper-board {
                max-width: 100%;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .settings {
                flex-direction: column;
                gap: 10px;
            }
            
            .cell {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 id="title">–°–∞–ø–µ—Ä</h1>
            <div class="settings">
                <div class="language-selector">
                    <button class="lang-btn active" data-lang="ru">RU</button>
                    <button class="lang-btn" data-lang="en">EN</button>
                </div>
                <div class="difficulty-selector">
                    <button class="diff-btn active" data-diff="easy">–õ–µ–≥–∫–æ</button>
                    <button class="diff-btn" data-diff="medium">–°—Ä–µ–¥–Ω–µ</button>
                    <button class="diff-btn" data-diff="hard">–°–ª–æ–∂–Ω–æ</button>
                </div>
            </div>
        </header>
        
        <div class="game-info">
            <div class="timer" id="timer">00:00</div>
            <div class="mines-counter" id="mines-counter">üí£: 10</div>
            <div class="lives" id="lives">
                <span class="heart">‚ù§</span>
                <span class="heart">‚ù§</span>
                <span class="heart">‚ù§</span>
            </div>
        </div>
        
        <div class="minesweeper-board" id="minesweeper-board"></div>
        
        <div class="game-status" id="game-status"></div>
        
        <div class="controls">
            <div class="action-buttons">
                <button class="action-btn" id="hint-btn">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
                <button class="action-btn primary" id="new-game-btn">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
            </div>
        </div>
    </div>

    <script>
        // –¢–µ–∫—Å—Ç—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–∞—Ö
        const translations = {
            ru: {
                title: "–°–∞–ø–µ—Ä",
                difficulty: "–°–ª–æ–∂–Ω–æ—Å—Ç—å",
                easy: "–õ–µ–≥–∫–∞—è",
                medium: "–°—Ä–µ–¥–Ω—è—è",
                hard: "–°–ª–æ–∂–Ω–∞—è",
                newGame: "–ù–æ–≤–∞—è –∏–≥—Ä–∞",
                hint: "–ü–æ–¥—Å–∫–∞–∑–∫–∞",
                complete: "–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –ø–æ–±–µ–¥–∏–ª–∏!",
                time: "–í—Ä–µ–º—è",
                mines: "–ú–∏–Ω—ã",
                lives: "–ñ–∏–∑–Ω–∏",
                gameOver: "–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –ù–∞—á–Ω–∏—Ç–µ –Ω–æ–≤—É—é –∏–≥—Ä—É.",
                mistake: "–û—à–∏–±–∫–∞! –ü–æ—Ç–µ—Ä—è–Ω–∞ –æ–¥–Ω–∞ –∂–∏–∑–Ω—å.",
                flag: "–§–ª–∞–≥",
                removeFlag: "–£–±—Ä–∞—Ç—å —Ñ–ª–∞–≥"
            },
            en: {
                title: "Minesweeper",
                difficulty: "Difficulty",
                easy: "Easy",
                medium: "Medium",
                hard: "Hard",
                newGame: "New Game",
                hint: "Hint",
                complete: "Congratulations! You won!",
                time: "Time",
                mines: "Mines",
                lives: "Lives",
                gameOver: "Game over! Start a new game.",
                mistake: "Mistake! You lost one life.",
                flag: "Flag",
                removeFlag: "Remove flag"
            }
        };

        // –¢–µ–∫—É—â–∏–π —è–∑—ã–∫
        let currentLanguage = 'ru';

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const titleElement = document.getElementById('title');
        const timerElement = document.getElementById('timer');
        const minesCounterElement = document.getElementById('mines-counter');
        const livesElement = document.getElementById('lives');
        const minesweeperBoard = document.getElementById('minesweeper-board');
        const hintBtn = document.getElementById('hint-btn');
        const newGameBtn = document.getElementById('new-game-btn');
        const gameStatus = document.getElementById('game-status');
        const langButtons = document.querySelectorAll('.lang-btn');
        const diffButtons = document.querySelectorAll('.diff-btn');

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let board = [];
        let minePositions = [];
        let revealedCells = 0;
        let flaggedCells = 0;
        let gameTime = 0;
        let timerInterval = null;
        let lives = 3;
        let gameActive = true;
        let firstClick = true;

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
        const difficultySettings = {
            easy: { rows: 9, cols: 9, mines: 10 },
            medium: { rows: 16, cols: 16, mines: 40 },
            hard: { rows: 16, cols: 30, mines: 99 }
        };

        let currentDifficulty = 'easy';
        let rows = 9;
        let cols = 9;
        let totalMines = 10;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            createBoard();
            startTimer();
            updateUI();
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            langButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    setLanguage(btn.dataset.lang);
                });
            });
            
            diffButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    setDifficulty(btn.dataset.diff);
                });
            });
            
            newGameBtn.addEventListener('click', startNewGame);
            hintBtn.addEventListener('click', giveHint);
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
        function createBoard() {
            minesweeperBoard.innerHTML = '';
            minesweeperBoard.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
            minesweeperBoard.style.gridTemplateRows = `repeat(${rows}, 1fr)`;
            
            board = [];
            for (let i = 0; i < rows; i++) {
                board[i] = [];
                for (let j = 0; j < cols; j++) {
                    const cell = document.createElement('div');
                    cell.classList.add('cell');
                    cell.dataset.row = i;
                    cell.dataset.col = j;
                    
                    // –õ–µ–≤—ã–π –∫–ª–∏–∫ - –æ—Ç–∫—Ä—ã—Ç—å —è—á–µ–π–∫—É
                    cell.addEventListener('click', () => revealCell(i, j));
                    
                    // –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ - –ø–æ—Å—Ç–∞–≤–∏—Ç—å/—É–±—Ä–∞—Ç—å —Ñ–ª–∞–≥
                    cell.addEventListener('contextmenu', (e) => {
                        e.preventDefault();
                        toggleFlag(i, j);
                    });
                    
                    minesweeperBoard.appendChild(cell);
                    board[i][j] = {
                        isMine: false,
                        isRevealed: false,
                        isFlagged: false,
                        adjacentMines: 0,
                        element: cell
                    };
                }
            }
        }

        // –†–∞–∑–º–µ—â–µ–Ω–∏–µ –º–∏–Ω –Ω–∞ –ø–æ–ª–µ
        function placeMines(excludeRow, excludeCol) {
            minePositions = [];
            let minesPlaced = 0;
            
            while (minesPlaced < totalMines) {
                const row = Math.floor(Math.random() * rows);
                const col = Math.floor(Math.random() * cols);
                
                // –ù–µ —Å—Ç–∞–≤–∏–º –º–∏–Ω—É –≤ –∏—Å–∫–ª—é—á–µ–Ω–Ω—É—é —è—á–µ–π–∫—É –∏ –≤–æ–∫—Ä—É–≥ –Ω–µ–µ
                if ((row === excludeRow && col === excludeCol) || 
                    (Math.abs(row - excludeRow) <= 1 && Math.abs(col - excludeCol) <= 1)) {
                    continue;
                }
                
                if (!board[row][col].isMine) {
                    board[row][col].isMine = true;
                    minePositions.push({row, col});
                    minesPlaced++;
                }
            }
            
            // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω –≤–æ–∫—Ä—É–≥ –∫–∞–∂–¥–æ–π —è—á–µ–π–∫–∏
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    if (!board[i][j].isMine) {
                        board[i][j].adjacentMines = countAdjacentMines(i, j);
                    }
                }
            }
        }

        // –ü–æ–¥—Å—á–µ—Ç –º–∏–Ω –≤–æ–∫—Ä—É–≥ —è—á–µ–π–∫–∏
        function countAdjacentMines(row, col) {
            let count = 0;
            for (let i = -1; i <= 1; i++) {
                for (let j = -1; j <= 1; j++) {
                    const newRow = row + i;
                    const newCol = col + j;
                    
                    if (newRow >= 0 && newRow < rows && newCol >= 0 && newCol < cols) {
                        if (board[newRow][newCol].isMine) {
                            count++;
                        }
                    }
                }
            }
            return count;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ—Ö —Ñ–ª–∞–≥–æ–≤
        function checkAllFlags() {
            const totalCells = rows * cols;
            let flaggedCells = 0;
            let correctFlags = 0;
            
            // –°—á–∏—Ç–∞–µ–º —Ñ–ª–∞–≥–∏ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ñ–ª–∞–≥–∏
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    const cell = board[i][j];
                    if (cell.isFlagged) {
                        flaggedCells++;
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—Ç–æ–∏—Ç –ª–∏ —Ñ–ª–∞–≥ –Ω–∞ –º–∏–Ω–µ
                        if (cell.isMine) {
                            correctFlags++;
                        }
                    }
                }
            }
            
            // –ï—Å–ª–∏ –≤—Å–µ –∫–ª–µ—Ç–∫–∏ –≤ —Ñ–ª–∞–≥–∞—Ö –ò –≤—Å–µ —Ñ–ª–∞–≥–∏ —Å—Ç–æ—è—Ç –Ω–∞ –º–∏–Ω–∞—Ö
            if (flaggedCells === totalCells && correctFlags === totalMines) {
                playRedFlagSound();
                return true;
            }
            
            // –ò–ª–∏ –µ—Å–ª–∏ –≤—Å–µ –º–∏–Ω—ã –ø–æ–º–µ—á–µ–Ω—ã —Ñ–ª–∞–≥–∞–º–∏ (–¥–∞–∂–µ –µ—Å–ª–∏ –µ—Å—Ç—å –ª–∏—à–Ω–∏–µ —Ñ–ª–∞–≥–∏)
            if (correctFlags === totalMines && flaggedCells >= totalMines) {
                playRedFlagSound();
                return true;
            }
            
            return false;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞
        function playRedFlagSound() {
            const audio = new Audio('redflag.mp3');
            audio.volume = 1.0;
            
            const playPromise = audio.play();
            if (playPromise !== undefined) {
                playPromise.catch(error => {
                    console.log("–ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ");
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ –∑–≤—É–∫ –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è
                    gameStatus.textContent = "üéµ RED FLAG! üéµ (–ó–≤—É–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω)";
                    gameStatus.style.color = '#ff5252';
                    setTimeout(() => {
                        if (gameActive) gameStatus.textContent = '';
                    }, 3000);
                });
            }
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ —è—á–µ–π–∫–∏
        function revealCell(row, col) {
            if (!gameActive || board[row][col].isRevealed || board[row][col].isFlagged) {
                return;
            }
            
            // –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∫–ª–∏–∫–µ —Ä–∞–∑–º–µ—â–∞–µ–º –º–∏–Ω—ã
            if (firstClick) {
                placeMines(row, col);
                firstClick = false;
            }
            
            const cell = board[row][col];
            
            // –ï—Å–ª–∏ –Ω–∞–∂–∞–ª–∏ –Ω–∞ –º–∏–Ω—É
            if (cell.isMine) {
                cell.isRevealed = true;
                cell.element.classList.add('revealed', 'mine');
                loseLife();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–ª–∞–≥–∏ –ø–æ—Å–ª–µ –ø–æ—Ç–µ—Ä–∏ –∂–∏–∑–Ω–∏ (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π)
                setTimeout(() => checkAllFlags(), 100);
                return;
            }
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º —è—á–µ–π–∫—É
            cell.isRevealed = true;
            cell.element.classList.add('revealed');
            revealedCells++;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω –≤–æ–∫—Ä—É–≥
            if (cell.adjacentMines > 0) {
                cell.element.textContent = cell.adjacentMines;
                cell.element.classList.add(`number-${cell.adjacentMines}`);
            } else {
                // –ï—Å–ª–∏ –º–∏–Ω –≤–æ–∫—Ä—É–≥ –Ω–µ—Ç, –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Å–æ—Å–µ–¥–Ω–∏–µ —è—á–µ–π–∫–∏ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ
                for (let i = -1; i <= 1; i++) {
                    for (let j = -1; j <= 1; j++) {
                        const newRow = row + i;
                        const newCol = col + j;
                        
                        if (newRow >= 0 && newRow < rows && newCol >= 0 && newCol < cols) {
                            if (!board[newRow][newCol].isRevealed && !board[newRow][newCol].isFlagged) {
                                revealCell(newRow, newCol);
                            }
                        }
                    }
                }
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—ã–∏–≥—Ä–∞–ª –ª–∏ –∏–≥—Ä–æ–∫
            checkWinCondition();
            
            // –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–ª–∞–≥–∏ –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–ª–µ—Ç–∫–∏
            setTimeout(() => checkAllFlags(), 100);
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ñ–ª–∞–≥–∞
        function toggleFlag(row, col) {
            if (!gameActive || board[row][col].isRevealed) {
                return;
            }
            
            const cell = board[row][col];
            
            if (cell.isFlagged) {
                cell.isFlagged = false;
                cell.element.classList.remove('flagged');
                flaggedCells--;
            } else {
                cell.isFlagged = true;
                cell.element.classList.add('flagged');
                flaggedCells++;
            }
            
            updateMinesCounter();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—Å–µ –ª–∏ –ø–æ–ª–µ –≤ —Ñ–ª–∞–≥–∞—Ö
            checkAllFlags();
        }

        // –ü–æ—Ç–µ—Ä—è –∂–∏–∑–Ω–∏
        function loseLife() {
            lives--;
            updateLivesDisplay();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
            gameStatus.textContent = translations[currentLanguage].mistake;
            gameStatus.style.color = '#ff5252';
            
            // –ï—Å–ª–∏ –∂–∏–∑–Ω–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å
            if (lives <= 0) {
                gameActive = false;
                clearInterval(timerInterval);
                gameStatus.textContent = translations[currentLanguage].gameOver;
                gameStatus.classList.add('game-over');
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –º–∏–Ω—ã
                revealAllMines();
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –º–∏–Ω—ã
        function revealAllMines() {
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    const cell = board[i][j];
                    if (cell.isMine && !cell.isRevealed) {
                        cell.isRevealed = true;
                        cell.element.classList.add('revealed', 'mine');
                    }
                }
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏—è –ø–æ–±–µ–¥—ã
        function checkWinCondition() {
            const totalCells = rows * cols;
            if (revealedCells === totalCells - totalMines) {
                gameActive = false;
                clearInterval(timerInterval);
                gameStatus.textContent = translations[currentLanguage].complete;
                gameStatus.style.color = '#4caf50';
                gameStatus.classList.add('game-won');
                
                // –ü–æ–º–µ—á–∞–µ–º –≤—Å–µ –º–∏–Ω—ã —Ñ–ª–∞–≥–∞–º–∏
                for (let i = 0; i < rows; i++) {
                    for (let j = 0; j < cols; j++) {
                        const cell = board[i][j];
                        if (cell.isMine && !cell.isFlagged) {
                            cell.isFlagged = true;
                            cell.element.classList.add('flagged');
                        }
                    }
                }
                flaggedCells = totalMines;
                updateMinesCounter();
            }
        }

        // –ü–æ–¥—Å–∫–∞–∑–∫–∞
        function giveHint() {
            if (!gameActive || firstClick) return;
            
            // –ù–∞—Ö–æ–¥–∏–º –±–µ–∑–æ–ø–∞—Å–Ω—É—é —è—á–µ–π–∫—É –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    const cell = board[i][j];
                    if (!cell.isRevealed && !cell.isFlagged && !cell.isMine && cell.adjacentMines === 0) {
                        revealCell(i, j);
                        return;
                    }
                }
            }
            
            // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω—É—é —è—á–µ–π–∫—É, –æ—Ç–∫—Ä—ã–≤–∞–µ–º –ª—é–±—É—é –Ω–µ –º–∏–Ω–Ω—É—é
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    const cell = board[i][j];
                    if (!cell.isRevealed && !cell.isFlagged && !cell.isMine) {
                        revealCell(i, j);
                        return;
                    }
                }
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∂–∏–∑–Ω–µ–π
        function updateLivesDisplay() {
            const hearts = livesElement.querySelectorAll('.heart');
            hearts.forEach((heart, index) => {
                if (index < lives) {
                    heart.classList.remove('empty');
                } else {
                    heart.classList.add('empty');
                }
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –º–∏–Ω
        function updateMinesCounter() {
            minesCounterElement.textContent = `üí£: ${totalMines - flaggedCells}`;
        }

        // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
        function startTimer() {
            gameTime = 0;
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                gameTime++;
                updateTimer();
            }, 1000);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞
        function updateTimer() {
            const minutes = Math.floor(gameTime / 60);
            const seconds = gameTime % 60;
            timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // –ù–æ–≤–∞—è –∏–≥—Ä–∞
        function startNewGame() {
            const settings = difficultySettings[currentDifficulty];
            rows = settings.rows;
            cols = settings.cols;
            totalMines = settings.mines;
            
            createBoard();
            startTimer();
            
            revealedCells = 0;
            flaggedCells = 0;
            lives = 3;
            gameActive = true;
            firstClick = true;
            
            gameStatus.textContent = '';
            gameStatus.classList.remove('game-over', 'game-won');
            gameStatus.style.color = '#e0e0e0';
            
            updateMinesCounter();
            updateLivesDisplay();
        }

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —è–∑—ã–∫–∞
        function setLanguage(lang) {
            currentLanguage = lang;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É —è–∑—ã–∫–∞
            langButtons.forEach(btn => {
                btn.classList.toggle('active', btn.dataset.lang === lang);
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç—ã
            updateUI();
        }

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
        function setDifficulty(diff) {
            currentDifficulty = diff;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
            diffButtons.forEach(btn => {
                btn.classList.toggle('active', btn.dataset.diff === diff);
            });
            
            // –ù–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—É—é –∏–≥—Ä—É —Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é
            startNewGame();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateUI() {
            titleElement.textContent = translations[currentLanguage].title;
            hintBtn.textContent = translations[currentLanguage].hint;
            newGameBtn.textContent = translations[currentLanguage].newGame;
            timerElement.textContent = `${translations[currentLanguage].time}: 00:00`;
            minesCounterElement.textContent = `${translations[currentLanguage].mines}: ${totalMines}`;
            updateMinesCounter();
            updateLivesDisplay();
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
